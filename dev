#!/bin/bash
# vim: ts=4 sw=4:

# remote testing session
PROJ="/x_proj/jenov/scripts/ymake_dev2"
CMD="ymake_dev2"
LIB="/x_proj/jenov/scripts/y_bash_lib"
DEST1="/usr/local/bin"
DEST2="/usr/local/bin"

DEF_SYNC="       -new_dev  -mountmisc --sync  -clgentoo  -update  -check  -build  -resume  -ckernel   -bkernel  -lilo  -grub_inst --grub  -rebuild  -qtest  -systest -D"
DEF_CHECK="      -new_dev --mountmisc  -sync  -clgentoo --update --check  -build  -resume  -ckernel   -bkernel  -lilo  -grub_inst  -grub  -rebuild  -qtest  -systest -D"
DEF_NEW_KERNEL=" -new_dev --mountmisc  -sync  -clgentoo  -update  -check  -build  -resume  -ckernel  --bkernel  -lilo  -grub_inst  -grub --rebuild --qtest  -systest -D"
DEF_TEST="       -new_dev --mountmisc  -sync  -clgentoo  -update --check  -build  -resume  -ckernel   -bkernel  -lilo  -grub_inst  -grub  -rebuild  -qtest  -systest -D"
DEF_BUILD="      -new_dev --mountmisc  -sync  -clgentoo --update --check --build  -resume  -ckernel   -bkernel  -lilo --grub_inst  -grub  -rebuild  -qtest  -systest -D"
DEF_ALL="        -new_dev --mountmisc --sync --clgentoo --update --check --build  -resume --ckernel  --bkernel  -lilo --grub_inst --grub --rebuild --qtest  -systest -D"

DEF_RESUME="     -new_dev --mountmisc -sync -clgentoo -update -check --build -resume --ckernel  --bkernel  -lilo --grub_inst --grub --rebuild --qtest  -systest -D"

test -n "$1" && eval CURRENT='$'"DEF_"$1
test -z "$CURRENT" -o "$CURRENT" = "$1" && { 
    echo MISSING mode definition
    env | grep DEF_
    exit 1; 
}
cp $PROJ $DEST1 1>/dev/null
cp $LIB $DEST2 1>/dev/null
DEV="b"
$CMD --mountdev /dev/sd${DEV}2=/boot,/dev/sd${DEV}1=/boot/efi,/dev/sd${DEV}5=/xdir --dev /dev/sd${DEV}4 --mnt /mnt $CURRENT $*
